"use strict";function e(e){var t=Buffer(e).toJSON();return t.hasOwnProperty("data")?t.data:t}function t(e){return Buffer(e).toString()}Object.defineProperty(exports,"__esModule",{value:!0});var n={TNF_EMPTY:0,TNF_WELL_KNOWN:1,TNF_MIME_MEDIA:2,TNF_ABSOLUTE_URI:3,TNF_EXTERNAL_TYPE:4,TNF_UNKNOWN:5,TNF_UNCHANGED:6,TNF_RESERVED:7,RTD_TEXT:"T",RTD_URI:"U",RTD_SMART_POSTER:"Sp",RTD_ALTERNATIVE_CARRIER:"ac",RTD_HANDOVER_CARRIER:"Hc",RTD_HANDOVER_REQUEST:"Hr",RTD_HANDOVER_SELECT:"Hs",BLOCK_SIZE:16,TLV_START:64,TL_LENGTH:4},r=n.TNF_EMPTY,o=n.TNF_WELL_KNOWN,i=n.TNF_MIME_MEDIA,a=n.TNF_ABSOLUTE_URI,s=n.TNF_EXTERNAL_TYPE,c=n.TNF_UNKNOWN,d=n.TNF_UNCHANGED,p=n.TNF_RESERVED,f=n.RTD_TEXT,u=n.RTD_URI,l=n.RTD_SMART_POSTER,T=function(e){var n=63&e[0];e.slice(1,1+n);return t(e.slice(n+1))},R=function(t,n,r){n||(n="en");var o=e(n+t);return o.unshift(n.length),o},E=["","http://www.","https://www.","http://","https://","tel:","mailto:","ftp://anonymous:anonymous@","ftp://ftp.","ftps://","sftp://","smb://","nfs://","ftp://","dav://","news:","telnet://","imap:","rtsp://","urn:","pop:","sip:","sips:","tftp:","btspp://","btl2cap://","btgoep://","tcpobex://","irdaobex://","file://","urn:epc:id:","urn:epc:tag:","urn:epc:pat:","urn:epc:raw:","urn:epc:","urn:nfc:"],_=function(e){var n=E[e[0]];return n||(n=""),n+t(e.slice(1))},h=function(t){var n,r,o;return E.slice(1).forEach(function(e){n&&"urn:"!==n||0!==t.indexOf(e)||(n=e)}),n||(n=""),o=e(t.slice(n.length)),r=E.indexOf(n),o.unshift(r),o},N=function(e){return new Buffer(e).toString()},v=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],c=arguments[4];return i instanceof Array&&(i=t(i)),a instanceof Array||(a=e(a)),s instanceof Array||(s=e(s)),n==o&&(i==f?c=T(s):i==u&&(c=_(s))),{tnf:n,type:i,id:a,payload:s,value:c}},g=function(t){var n=[],r=void 0,o=void 0,i=void 0,a=void 0,s=void 0,c=void 0,d=void 0,p=void 0,f=void 0;for(s=0;s<t.length;s++)c=0===s,d=s===t.length-1,p=t[s].payload.length<255,f=t[s].id.length>0,r=x(c,d,!1,p,f,t[s].tnf),n.push(r),o=e(t[s].type),n.push(o.length),p?(i=t[s].payload.length,n.push(i)):(i=t[s].payload.length,n.push(i>>24),n.push(i>>16),n.push(i>>8),n.push(255&i)),f&&(a=t[s].id.length,n.push(a)),n=n.concat(o),f&&(n=n.concat(t[s].id)),n=n.concat(t[s].payload);return n},y=function(e){for(var t=e.slice(0),n=[],r=void 0,o=void 0,i=0,a=0,s=0,c=[],d=[],p=[];t.length&&(r=t.shift(),o=A(r),i=t.shift(),a=o.sr?t.shift():(255&t.shift())<<24|(255&t.shift())<<16|(255&t.shift())<<8|255&t.shift(),o.il&&(s=t.shift()),c=t.splice(0,i),d=t.splice(0,s),p=t.splice(0,a),n.push(v(o.tnf,c,d,p)),!o.me););return n},A=function(e){return{mb:0!=(128&e),me:0!=(64&e),cf:0!=(32&e),sr:0!=(16&e),il:0!=(8&e),tnf:7&e}},x=function(e,t,n,r,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:i;return e&&(a|=128),t&&(a|=64),n&&(a|=32),r&&(a|=16),o&&(a|=8),a},F={stringify:function(e,t){return Array.isArray(e)?("number"==typeof e[0]&&(e=y(e)),F.printRecords(e,t)):F.printRecord(e,t)},printRecords:function(e,t){return t||(t="\n"),result="",e.forEach(function(e){result+=F.printRecord(e,t),result+=t}),result.slice(0,-1*t.length)},printRecord:function(e,t){var n="";switch(t||(t="\n"),e.tnf){case ndef.TNF_EMPTY:n+="Empty Record",n+=t;break;case ndef.TNF_WELL_KNOWN:n+=F.printWellKnown(e,t);break;case ndef.TNF_MIME_MEDIA:n+="MIME Media",n+=t,n+=N(e.type),n+=t,n+=N(e.payload);break;case ndef.TNF_ABSOLUTE_URI:n+="Absolute URI",n+=t,n+=N(e.type),n+=t,n+=N(e.payload);break;case ndef.TNF_EXTERNAL_TYPE:n+="External",n+=t,n+=N(e.type),n+=t,n+=N(e.payload);break;default:n+=N("Can't process TNF "+e.tnf)}return n+=t},printWellKnown:function(e,t){var n="";if(e.tnf!==ndef.TNF_WELL_KNOWN)return"ERROR expecting TNF Well Known";switch(e.type){case ndef.RTD_TEXT:n+="Text Record",n+=t,n+=ndef.text.decodePayload(e.payload);break;case ndef.RTD_URI:n+="URI Record",n+=t,n+=ndef.uri.decodePayload(e.payload);break;case ndef.RTD_SMART_POSTER:n+="Smart Poster",n+=t,n+=F.printRecords(ndef.decodeMessage(e.payload));break;default:n+=e.type+" Record",n+=t,n+=N(e.payload)}return n}},M={stringifier:F};exports.record=v,exports.textRecord=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return v(o,f,n,R(e,t))},exports.uriRecord=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return v(o,u,t,h(e))},exports.absoluteUriRecord=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return v(a,e,n,t)},exports.mimeMediaRecord=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return v(i,e,n,t)},exports.smartPoster=function(e,t,n){return n=[],e?n=e[0]instanceof Object&&e[0].hasOwnProperty("tnf")?g(e):e:console.warn("WARNING: Expecting an array of NDEF records"),v(o,l,t,n)},exports.emptyRecord=function(){return v(r,[],[],[])},exports.androidApplicationRecord=function(e){return v(s,"android.com:pkg",[],e)},exports.encodeMessage=g,exports.decodeMessage=y,exports.decodeTnf=A,exports.encodeTnf=x,exports.isType=function(e,t,n){return e.tnf===t&&N(e)===N(n)},exports.tnfToString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return e==r?t="Empty":o?t="Well Known":i?t="Mime Media":a?t="Absolute URI":s?t="External":c?t="Unknown":d?t="Unchanged":p&&(t="Reserved"),t},exports.stringify=M;
//# sourceMappingURL=index.min.js.map
